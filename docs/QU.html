<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="keywords" content="JTSDK, JT-ware, wsjtx, jtdx, js8call, build wsjtx, compile wsjtx, Qt, Windows, software, development">
	<title>Hamlib SDK v3.2.3 User Guide</title>
	<link rel="stylesheet" href="style-new.css">
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
</head>

<body>
	
<table width="100%" border="0">
	<tr>
		<td>
			<table width="*" border="0">
    			<tr>
      				<td>
						<img src="favicon.ico" alt=""/>
					</td>
      				<td>
		  				<h1>HAMLIB SDK </h1>
						<h2>Evolving the JT-ware Software Developer's Kit (JTSDK)</h2>
					</td>
    			</tr>
  			</table>
		</td>
		<td align="right" style="vertical-align: top"  >
			<a href="UG.html"><img src="UGIcon.png" width="34" height="33" alt=""/></a>
			<a href="index.html"><img src="HomeIcon.png" width="34" height="33" alt=""/></a>
		</td>
	</tr>
</table>

	<hr>
	<table width="100%" border="0">
		<tr>
			<td width="12.5%" align="center"><a href="DG.html">Installation</a></td> 
			<td width="12.5%" align="center"><a href="DG-Build-x64-JT-ware.html">Build x64</a></td>
			<td width="12.5%" align="center"><a href="DG-Build-x86-JT-ware.html">Build x86</a></td>
		    <td width="12.5%" align="center"><a href="DO.html">Developers</a></td>
			<td width="12.5%" align="center"><a href="AN.html">Notes</a></td> 
			<td width="12.5%" align="center"><a href="QU.html">Questions</a></td>
			<td width="12.5%" align="center"><a href="https://sourceforge.net/projects/hamlib-sdk/">Sourceforge</a></td> 
			<td width="12.5%" align="center"><a href="https://sourceforge.net/projects/hamlib-sdk/files/Windows/JTSDK-3.2-Stream/">Download</a</td>
		</tr>
	</table>
	<hr/>
	<h2>JTSDK 3.2.3 Questions and Suggestions for Resolving for Common Issues</h2>
	<hr>
	<h3>What has happened to the original JTSDK creator?</h3>
    <ul>
		<p><a href="https://github.com/KI7MT">Greg Beam KI7MT</a> is still around and with us on the JTSDK Forum at <a href="https://groups.io/g/JTSDK">jtsdk@groups.io</a>. People's interests change; you will see from Greg's posts that he has evolved past active JTSDK development. 
		</p><p>We cannot thank Greg more highly for his past and ongoing work - especially as a mentor at this point in time.</p>
	<p>No politics here. This is not a push out or push aside. The 'hamlibdk' group as entities seek no glory nor recognition. Contributors just evolved work where Greg left off as the need was there for this to occur.</p>
<p>Other developers have gone silent (but may still be around in the background) due to some of the nastiness in our environment.&nbsp;</p>
</ul>
	<h3>Where can I ask question ?</h3>
    <ul>
	  <p>The original JTSDK Forum <a href="https://groups.io/g/JTSDK">jtsdk@groups.io</a> is used as the primary communication point for this project.</p>
		<p>Have no hesitations posting questions to there. If you are unable to post then email main contributors in that forum directly.</p>
	</ul>
	<h3>Windows 11: Deployments grind to a halt</h3>
    <ul>
  	<p>UnderWindows 11 sometimes users have observed that the tasks appear to grind to a halt.</p>
		<p>We have no answers to why this happens.</p>
		<p>Press ENTER in the "stalled" Window and all seems to come back to life..</p>
	</ul>
	<h3>What happens if I receive a PowerShell security warning? Is it safe to run the PowerShell Scripts?</h3>
    <ul>
	<p>You may receive the following <strong>security notification</strong>:</p>
	</ul>
<div class="reducewidth"> <pre>
Execution Policy Change
The execution policy helps protect you from scripts that you do not trust. Changing 
the execution policy might expose you to the security risks described in the 
about_Execution_Policies help topic at https:/go.microsoft.com/fwlink/?LinkID=135170. 
Do you want to change the execution policy?
[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is "N"):
</pre>
	</div>
	<ul>
	<p>It is safe to select <strong>Y</strong>. These scripts are not any processor flaw tests. Remember
	that developing these scripts is also a learning exercise for the Development Team.</p>
	</ul>
	
	<h3>How does the SDK use PowerShell? Why does the SDK need to use PowerShell when previous kits used CMD scripts?</h3>
	
	<ul>
	<p>The second part first: PowerShell creates a HIGHLY EXTENSIBLE scripted environment. The PowerShell environment is much more powerful and offers facilities that vastly eclipse capabilities of the old CMD.EXE processor and its scripts. Many tasks became onerous and were pushing the boundaries of what CMD.EXE-capable scripts could perform. Some tasks (such as extracting version information from the <strong>cmake</strong> files) became near impossible with CMD.EXE scripts. Therefore the PowerShell 'universal' scripting environment - provided by Microsoft STANDARD with Windows - was selected as the investigation tool for this project.</p>
	<p>The basic concept of supporting <strong>Windows Environment Variables</strong> through <a href="https://docs.microsoft.com/en-us/powershell/">PowerShell</a> 
	<strong>$env:<env-var></strong> facilities ease access into CMake, QMake and the MinGW compilers - components that will always remain a cornerstone concepts.</p>
	</ul>
	
<h3>How do I upgrade existing JTSDK deployments?</h3>
	<ul>
	<p>The <a href="https://sourceforge.net/projects/hamlib-sdk/files/Windows/JTSDK-3.2-Stream/JTSDK64-Base-3.2.3.exe">JTSDK64-Base-3.2.3</a> can be installed over the top of previous kits - yet it is 
	highly recommended that one start from scratch. </p>
	<p><strong> It is highly recommended that kits are deployed into Virtual machines (see <a href="DG.html">Installation</a> section).</strong> </p>
	<p>It is highly recommended that a new, fresh deployment be considered with each new base package release.</p>
	<p>You can keep old deployment(s) by closing all open environment windows and renaming the deployment folder (i.e. <strong>C:\JTSDK64-Tools</strong> to <strong>C:\JTSDK64-Tools-Old</strong>) </p>
	<p>If you need to revert back to your old deployment then all you need do is rename that folder back to its original filename (i.e. <strong>C:\JTSDK64-Tools-Old</strong> back to <strong>C:\JTSDK64-Tools</strong>) </p>
	</ul>
	
<h3>How do I update the JTSDK?</h3>
	
	<ul>
	<p>Maintenance updates will be applied in the form of &quot;Tools&quot; packages. These packages 
	are designed to be deployed to existing &quot;Base&quot; packages.</p>
	</ul>
	
<h4>Where do I get and how do I apply 'Tools' packages?</h4>

	<ul>
	  <p><strong></strong>&quot;Tools&quot; packages are updates to the <strong></strong>&quot;Base&quot; environments.</p>
	<p><em>These steps assume that you have a deployed base environment</em></p>
	<ul>
	<li>Download any &quot;Tools&quot; packages from <a href="https://sourceforge.net/projects/hamlib-sdk/files/Windows/JTSDK-3.2-Stream/">https://sourceforge.net/projects/hamlib-sdk/files/Windows/JTSDK-3.2-Stream/</a> </li>
	</ul>
	<p><strong>Note:</strong> The current "Tools" Package is&nbsp; <a href="https://sourceforge.net/projects/hamlib-sdk/files/Windows/JTSDK-3.2-Stream/JTSDK64-Tools-3.2.3.2.exe">JTSDK64-Tools-3.2.3.2.exe</a> .</p>
	<ul>
	<li>Deploy the tools package to your JTSDK install directory.</li>
	</ul>
	<p>Updates may apply to the MSYS2 environment. Therefore the &quot;profile&quot; directory for 
	MSYS2 should be deleted and re-created.</p>
	<ul>
		<li>(Optional) Copy any folders stored under <strong>x:\JTSDK64-Tools\tools\msys64\home</strong> to a backup location. This should enable you to access previous work.</li>
		
		<li>Close any open MSYS2 environment terminal(s).</li>
		
		<li>Perform the system upgrade.</li>
		
		<li>Delete folders that exist under <strong>x:\JTSDK64-Tools\tools\msys64\home</strong>.</li>
	  
		<ul>
			<li>i.e: PowerShell: <strong> Remove-Item &quot;C:\JTSDK64-Tools\tools\msys64\home*&quot; -Recurse -Force </strong></li>
		</ul>
		
		<li>Re-open MSYS2 with the <strong>msys2</strong> command for maintenance or <strong>mingw64</strong> for development work inside the PowerShell terminal</li>
	</ul>
	<p><strong>Note:</strong> The <strong>src</strong> directory in your backup should contain your previous work. It is safe to copy this enture folder across to your new MSYS2 Profile.</p>
	<p>You will need to pull down your Hamlib repository again and/or restore any custom work 
	to folders created within the MSYS2 environment. See Step 3b below.</p>
	</ul>

<hr>
<h2>Issues and Potential Work Arounds</h2>
<hr>
<ul>
	<p>Environments have become EXTREMELY COMPLEX. What can work on one machine may not work on another.</p>
	<p>These notes may assist you getting around some of the issues that have been observed.</p>
</ul>
<h3>VC 2022 Runtimes Deployment Error during <strong>postinstall</strong></h4>   

    <ul>
    <p>When you start up the <em>JTSDK64-Setup</em> environment in <strong>Windows 11</strong> you may notice the following:</p>
    </ul>
	<div class="reducewidth">
<pre>
-------------------------------------------
           JTSDK Setup v3.2.3.2
-------------------------------------------

  Required Tool Status

     VC Runtimes ....... Not Installed
     Git ............... Not Installed
     OmniRig ........... Not Installed

  Qt Script-Provisioned Tool Chain Status

     x64:

     MinGW 8.1 ......... Qt Not Installed
     MinGW 9.0 (11.2) .. Qt Not Installed

     x86:

     MinGW 8.1 ......... Qt Not Installed

  Optional Component Status

     VS Code ........... Not Installed
     Boost ............. Not Installed

  Post Install / Manual Setup Commands

     Main Install ...... postinstall
     MSYS2 Shell ....... msys2>
</pre> </div>
    <ul>    
        <p>In the above example it is shown that the VC 2022 Runtimes are not deployed.</p>
        <p>When you run <strong>postinstall</strong> with deployment of VC 2022 Runtimes selected for deployment the following error occurs:</p>
    </ul>
	<div class="reducewidth">
<pre>
...
 Enter Your Install/Redeployment Selection(s):

(required) VC/C++ Runtimes (Y|N) .: y
...
...
-----------------------------------------------------
Installing Visual C/C++ x86 and x64 Runtimes
-----------------------------------------------------

* Downloading VC/C++ Installer

  --> Downloading the latest VC/C++ x86 Installer: Complete
  --> Downloading the latest VC/C++ x64 Installer: Complete

-----------------------------------------------------
 Visual C/C++ Runtime - Error In x86 Install
-----------------------------------------------------

****************************************************
Processing Error
****************************************************

The exit status from step [ VC Runtimes Install ] returned
a non-zero status. Check the error message and
and try again.

If the problem presists, contact: JTSDK@Groups.io

PS C:\JTSDK64-Tools\tools\setup\vcruntime>
</pre> </div>
    <ul>    
        <p>This is because LATER versions of the VC Runtimes may be reployed in your Windows 11 deployment</p>
        <p>The postinstall script has difficulty handling and detecting later versions of the VC runtimes.</p>
        <p>This can be resolved with the following simple procedure:</p>
        <ul>
            <li>Restart the deployment.</li>
            <li>Ignore the deployment of The VC 2022 runtimes (i.e. select 'N') if you experience this error.</li>
        </ul>
    </ul>
    
<h3>Wrong Qt deployment settings</h3>
<ul> 
<p>By far the most common issue observed has occurred when end users have performed default deploys of&nbsp; <strong>Qt 5.12.12</strong> under past kits. <strong>Qt 5.12.x</strong> is no longer supported.</p>
<p><strong>Qt 5.15.2</strong> is the default version of Qt used for development.</p>

<p>Most development and testing has been performed with <strong>Qt 5.15.2</strong> and its <strong>MinGW 8.1</strong> environment.</p>
<table width="*" align="center" border="1">
		<tr>
			<td class="custd"><strong>All libraries and software including Boost, Hamlib and the JT-ware should be rebuilt if not using <strong>Qt 5.15.2</strong>.</strong></td>
		</tr>
	</table>

<p>The marker file to set the version of Qt used is found in <strong>x:\JTSDK64-Tools\config</strong> i.e. <strong>qt5.15.2</strong> (as default).</p>
<p>Rename that file as appropriate to match the version of Qt that is deployed or that you want to use i.e. from <strong>qt5.15.2</strong> to <strong>qt6.5.1 </strong>.&nbsp;</p>
</ul>
<h3>Issues observed when trying to build software with Qt 6.5.1 deployments</h3>
<p><strong>Qt 6</strong> is not currently supported by the JT-ware developers. Current source code of all known JT-ware forks at the time that this document was written will not compile under <strong>Qt 6</strong>.</p>
<p>JT-ware developers are researching Qt 6-compatible code conversion.&nbsp;</p>
<h3>JT-ware compile error around code that uses the Resource Compilers</h3>
<ul> 
<p>Many users have observed a compiler error (especially with JTDX) at around the 60% mark that relates to the Resource Compiler.</p>
</ul>
	<div class="reducewidth">
<pre>
[ 14%] gcc.exe:Building Fortran object CMakeFiles/wsjt_fort_omp.dir/lib/chkmsg.f90.obj
error: C:JTSDK64-Toolstmpwsjtx-outputqt5.15.22.5.4ReleasebuildVersionResource_wsprd.rc: 
No such file or directory
gcc.exe: warning: '[ 14%] Building Fortran object CMakeFiles/wsjt_fort.dir/lib/chkmsg.f90.obj
-x c' after last input file has no effect
gcc.exe: fatal error: no input files
compilation terminated.
/usr/bin/windres: preprocessing failed.
</pre></div>
	<ul>
	<p>This is  a conflict caused by the complexity of resources i.e. Mixing of Qt-supplied MinGW and MSYS2-supplied tools/compilers.</p>
<p>The "NCD" version gets you to deploy the <strong>MSYS2</strong> tools and <strong>mingw64</strong> compilers yourself. Possibly new dependencies are conflicting with those supplied by the Qt MinGW compiler sets.&nbsp; &nbsp;&nbsp;</p>
<p><strong>Resolution: Rename MSYS2 windres.exe</strong></p>
	<ul>
	<li>Delete the source and build folders in <strong>C:\JTSDK64-Tools\tmp</strong> (use the Windows File Manager as its easier than PowerShell Commands)
	<ul>
	<br/>
	<li>For the brave, enter the following commands at a <em>JTSDK64-Tools</em> Command Prompt:</li>
	</ul>
	<br/>
	</li>
	</ul>
	<div style="padding-left: 120px;"><strong>Set-Location -Path</strong> &#34;C:\JTSDK64-Tools\tmp&#34;<br/><br/><strong>Get-ChildItem -Recurse -Filter</strong> &#34;wsjtx*&#34;<strong> | Remove-Item -Force -Recurse</strong>   <span style="color: yellow"><strong>&nbsp; &nbsp; &lt;== BE CAREFUL</strong>: This can be as dangerous as a Unix <strong>rm -rf *</strong> if executed in the wrong path.</span><br/><br/></div>
	<ul>
	<li>Execute the following command at the PowerShell prompt:</li>
	</ul><br/>
	<div style="padding-left: 60px;"><strong>Rename-Item -Path </strong>&#34;C:\JTSDK64-Tools\tools\msys64\usr\bin\windres.exe&#34;<strong> -NewName </strong>&#34;windres.exe.disabled&#34;<br/><br/></div>
	<ul>
	<li>- Re-start the JT-ware build process.</li>
	</ul>
	<p><a href="https://groups.io/g/JTSDK/message/1780">Thanks for the reminder Tom (and Mike)</a> :-)</p>
</ul>

<h3>Minor packaging issue observed when building JTDX</h3>
<ul>
<p>A CPACK issue may be observed when the JTSDK is deployed to a FRESH Windows OS.</p>
</ul>
	<div class="reducewidth">
<pre>
...
CPack: - Run preinstall target for: jtdx
CPack: - Install project: jtdx []
warning: target 'libhamlib-4.dll' is not absolute...
warning: target 'libhamlib-4.dll' does not exist...
CMake Error at C:/JTSDK64-Tools/tmp/wsjtx/CMake/Modules/GetPrerequisites.cmake:817 (message):
  C:/JTSDK64-Tools/tools/Qt/Tools/mingw810_64/bin/objdump.exe failed: 1

  C:/JTSDK64-Tools/tools/Qt/Tools/mingw810_64/bin/objdump.exe:
  'libhamlib-4.dll': No such file

Call Stack (most recent call first):
  C:/JTSDK64-Tools/tmp/wsjtx/CMake/Modules/GetPrerequisites.cmake:942 (get_prerequisites)
  C:/JTSDK64-Tools/tmp/wsjtx/CMake/Modules/BundleUtilities.cmake:584 (get_prerequisites)
  C:/JTSDK64-Tools/tmp/wsjtx/CMake/Modules/BundleUtilities.cmake:804 (get_bundle_keys)
  C:/JTSDK64-Tools/tmp/wsjtx-output/qt/5.15.2/2.2.0/Release/build/cmake_install.cmake:153 (fixup_bundle)

CPack Error: Error when generating package: jtdx
mingw32-make.exe: *** [Makefile:112: package] Error 1

--------------------------------------------
 WINDOWS INSTALLER BUILD ERROR
--------------------------------------------

 There was a problem building the package,
 or the script could not find:

 C:\JTSDK64-Tools\tmp\wsjtx-output\qt\5.15.2\2.2.0\Release\build\

 Check the Cmake logs for any errors, or
 correct any build script issues that were
 obverved and try to rebuild the package.

PS C:\JTSDK64-Tools\tmp\wsjtx-output\qt\5.15.2\2.2.0\Release\build>
</pre></div>
	<ul>
	<p><strong>Issue:</strong> Unable to package JTDX because of NUMEROUS DLL's reported as being missing</p>

	<p><strong>Resolution:</strong> Issue an appropriate command to find the path of necessary libraries before performing a <strong>jtbuild package </strong>command</p>
<ul>
<li>If you are using <strong>Qt 5.15.2</strong>:&nbsp;</li>
<ul>
<p><strong>$env:Path += "</strong>;C:\Windows\SysWOW64\downlevel;C:\JTSDK64-Tools\tools\hamlib\qt\5.15.2\bin<strong>"</strong></p>
	</ul>
<li>If you are using <strong>Qt 6.5.1</strong>:&nbsp;</li>
<ul>
<p><strong>$env:Path += "</strong>;C:\Windows\SysWOW64\downlevel;C:\JTSDK64-Tools\tools\hamlib\qt\6.5.1\bin<strong>"</strong></p>
</ul>
</ul>
	<p>These paths can be added to the main Windows system paths.</p>
		
	<ul>
		<li>Control Panel/About/Advanced System Settings/Advanced/Environment Variables.</li>
		<li>Append the lines to the existing local user's path:</li>
		<ul>
			<li>For <strong>Qt 5.15.2</strong>:</li>
			<br/>
			<strong>C:\Windows\SysWOW64\downlevel;C:\JTSDK64-Tools\tools\hamlib\qt\5.15.2\bin</strong>
			<br/><br/>
			<li>For <strong>Qt 6.5.1</strong>:</li>
			<br/>
			<strong>C:\Windows\SysWOW64\downlevel;C:\JTSDK64-Tools\tools\hamlib\qt\6.5.1\bin</strong>
		</ul>
		<br/>
		<li>Restart the build proess i.e. <strong>jtbuild package</strong></li>
	</ul>

	<p><span style="text-decoration: underline;">The issue will NOT be coded into a fix at this stage for the JTSDK as it may upset something else</span>.</p>

	<p>WSJT-X does NOT demonstrate the issue. JTDX does. Therefore in all probability the issue is with JTDX and its CMAKE scripts. Further reports to the JTDX forum if it is observed may assist in resolution. A direct report of this issue has already been made to JTDX Developers.</p>
	<p>Ref: <a href="https://groups.io/g/JTSDK/message/1779">https://groups.io/g/JTSDK/message/1779</a></p>
</ul>
<h3>Anomalies that do not make sense</h3>
<ul>
<p><strong>Note:</strong>This issue is different to the one described before this. Review messages carefully.</p>	
<p>During development and testing quite a number of issues were observed that were VERY FRUSTRATING and DID NOT MAKE ANY SENSE.</p>
	<p>An example is provided below within JTDX where a deployment has been performed, a JTDX build successfully completed (and packaged), yet after a system reboot the following error was observed (again in CPACK):</p>
</ul>
<div class="reducewidth">
<pre>
...
CPack: - Install project: jtdx []
CMake Error at C:/JTSDK64-Tools/tmp/wsjtx/CMake/Modules/GetPrerequisites.cmake:817 (message):
  C:/JTSDK64-Tools/tools/Qt/Tools/mingw810_64/bin/objdump.exe failed: 1

Call Stack (most recent call first):
  C:/JTSDK64-Tools/tmp/wsjtx/CMake/Modules/GetPrerequisites.cmake:942 (get_prerequisites)
  C:/JTSDK64-Tools/tmp/wsjtx/CMake/Modules/GetPrerequisites.cmake:942 (get_prerequisites)
  C:/JTSDK64-Tools/tmp/wsjtx/CMake/Modules/GetPrerequisites.cmake:942 (get_prerequisites)
  C:/JTSDK64-Tools/tmp/wsjtx/CMake/Modules/BundleUtilities.cmake:584 (get_prerequisites)
  C:/JTSDK64-Tools/tmp/wsjtx/CMake/Modules/BundleUtilities.cmake:804 (get_bundle_keys)
  C:/JTSDK64-Tools/tmp/wsjtx-output/qt/5.15.2/2.2.0/Release/build/cmake_install.cmake:153 (fixup_bundle)


CPack Error: Error when generating package: jtdx
mingw32-make.exe: *** [Makefile:112: package] Error 1

--------------------------------------------
 WINDOWS INSTALLER BUILD ERROR
--------------------------------------------
...
</pre></div>
<ul>
	<p><strong>Possible Cause</strong>: it is more than likely that a deployed MSYS2 utility is somehow conflicting with the set of utilities provided by Qt's MinGW Compiler set. (Ed. Note: This proved to be the case in this instance).</p>
	<p><strong>Test for this Issue</strong>: <u>Disable path access to the MSYS2 Tools from the <strong>JTSDK64-Tools</strong> Environment</u>.</p>
	<ul>
		<li>Edit <strong>C:\JTSDK64-Tools\config\Versions.ini</strong></li>
		<li>Change key <em>unixtools=enabled</em> to <em>unixtools=disabled</em></li>
		<li>Save and exit.</li>
		<li>Close all MSYS2 and Powershell Terminals</li>
		<li>Re-launch the <strong>JTSDK64-Tools</strong> environment.</li>
		<li>Re-attempt the build.</li>
	</ul>
	<p>If the build succeeds then it is more than likely that SOMEHOW a MSYS2/mingw64 etc. tool is conflicting.</p>

	<p>At this point you should review changes made to your environment and  reset the <em>unixtools</em> key to <em>unixtools=enabled </em>. </p>
	<p>Should all self-diagnosis attempts fail then seek further advice at the  <a href="https://groups.io/g/JTSDK">JTSDK Forum</a>.</p>
</ul>
<hr>
<h2>Conclusion and Further References</h2>
<hr>
	<ul>
	<p>The aim of <strong>JTSDK64-Tools</strong> is to use an Agile delivery approach to create a
	high-quality, yet flexible build system. </p>
	<p>Base ref: <a href="https://sourceforge.net/projects/hamlib-sdk/files/Windows/JTSDK-3.2-Stream/README.md">https://sourceforge.net/projects/hamlib-sdk/files/Windows/JTSDK-3.2-Stream/README.md</a></p>
	</ul>
<hr>
	<table width="100%" border="0">
	  <tbody>
		<tr>
		  <td>Author: <a href="https://www.qrz.com/db/vk3vm">Steve VK3VM/VK3SIR</a></td>
		  <td align="right"><a href="hamlibdk [at] outlook.com"
			rel="nofollow"
			onclick="this.href='mailto:' + 'hamlibdk' + '@' + 'outlook.com'">Contact</a></td>
		</tr>
	  </tbody>
	</table>	
</body>
</html>